# Contact Control Panel for Recording



## 概要

Amazon ConnectのContact Control Panelの機能を拡張し、通話の音声を録音できるようにしました。



## 環境構築

### Webサーバー側

1. ソースコードをダウンロードします。
2. "ccp4r-config.js"にあるinstanceNameという変数に、Amazon Connectのインスタンス名を設定します。
3. Webサーバーにhttpsで公開します。



### Amazon Connect側

1. AWSマネジメントコンソールにログインします。
2. Amazon Connectのホーム画面を開き、インスタンスエイリアスのリンクをクリックします。
3. [アプリケーション統合]をクリックします。
4. [オリジンの追加]をクリックします。
5. Webサーバのドメイン名またはポート番号までを入力し、[追加]をクリックします。
   - 最後に"/"があると追加できないのでご注意ください。



## 使用方法

1. ご利用の端末にヘッドセットを接続します。
2. 最新のMozilla FirefoxかGoogle Chromeで、Webサーバーに配置した"index.html"を開きます。
3. Webブラウザからマイクの使用許可を尋ねられた場合は許可します。
4. [サインイン]ボタンをクリックします。
5. タブが追加され、そこにログイン画面が表示されます。
   いつも通り[ユーザー名]と[パスワード]を入力し、[サインイン]をクリックします。
6. タブが削除され、元の画面に戻ります。
7. CCPの画面が表示されているので、いつも通り通話を行います。
8. 通話が完了すると、直前の通話の内容がそのまま再生されます。
   音声のコントローラーを操作すれば、オペレーター側とお客様側で別々に聞くこともできます。
   ダウンロードのリンクから音声をダウンロードすることもできます。



## 開発者向け情報

### グローバル変数

"ccp4r"を使用します。



### メンバ変数

- ccp4r.isRecordingEnabled: Webブラウザで録音の準備が出来たらtrueを、出来ていない場合はfalseを返します。



### 関数

- ccp4r.subscribeInit(callback): 初期化時のコールバック関数を登録します。コールバック関数に引数はありません。
- ccp4r.unsubscribeInit(callback): 初期化時のコールバック関数の登録をすべて解除します。
- ccp4r.subscribeLogging(): ログ出力時のコールバック関数を登録します。コールバック関数には第一引数にログメッセージの文字列が渡されます。
- cp4r.unsubscribeLoggingAll(): ログ出力時のコールバック関数の登録をすべて解除します。